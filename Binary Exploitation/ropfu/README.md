# ropfu

## Description

What's ROP?
Can you exploit the following [program](https://artifacts.picoctf.net/c/266/vuln) to get the flag? [Download source.](https://artifacts.picoctf.net/c/266/vuln.c)
nc saturn.picoctf.net 53905

Hint: This is a classic ROP to get a shell

## Approach

ROP, or return-oriented programming, is a vulnerability a step above basic buffer overflow attacks. A stack that would normally be marked as non-executable can be exploited through ROPChains, a system of pointers that lead eventually to a syscall. Let's take a look at the source code:

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#include <sys/types.h>

#define BUFSIZE 16

void vuln() {
  char buf[16];
  printf("How strong is your ROP-fu? Snatch the shell from my hand, grasshopper!\n");
  return gets(buf);
}

int main(int argc, char **argv){

  setvbuf(stdout, NULL, _IONBF, 0);
  

  // Set the gid to the effective gid
  // this prevents /bin/sh from dropping the privileges
  gid_t gid = getegid();
  setresgid(gid, gid, gid);
  vuln();
}
```

